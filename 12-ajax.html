<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第12章 Ajax | nodejs 入门教程</title>
    <meta name="description" content="持续更新中...">
    
    
    <link rel="preload" href="/assets/css/0.styles.382af5d5.css" as="style"><link rel="preload" href="/assets/js/app.8174091a.js" as="script"><link rel="preload" href="/assets/js/3.07be1171.js" as="script"><link rel="prefetch" href="/assets/js/10.5b11cab0.js"><link rel="prefetch" href="/assets/js/11.bf1f3f16.js"><link rel="prefetch" href="/assets/js/12.d6508346.js"><link rel="prefetch" href="/assets/js/13.52f6c1ad.js"><link rel="prefetch" href="/assets/js/14.c75697e3.js"><link rel="prefetch" href="/assets/js/15.775c8708.js"><link rel="prefetch" href="/assets/js/16.10809650.js"><link rel="prefetch" href="/assets/js/17.60279c5d.js"><link rel="prefetch" href="/assets/js/18.421777c3.js"><link rel="prefetch" href="/assets/js/19.960356be.js"><link rel="prefetch" href="/assets/js/2.0e940fbb.js"><link rel="prefetch" href="/assets/js/20.4c2a40dc.js"><link rel="prefetch" href="/assets/js/21.73a1e8cb.js"><link rel="prefetch" href="/assets/js/4.7a89c0f9.js"><link rel="prefetch" href="/assets/js/5.5ba4cb83.js"><link rel="prefetch" href="/assets/js/6.b7415607.js"><link rel="prefetch" href="/assets/js/7.719e35e5.js"><link rel="prefetch" href="/assets/js/8.d8593f62.js"><link rel="prefetch" href="/assets/js/9.52f01050.js">
    <link rel="stylesheet" href="/assets/css/0.styles.382af5d5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">nodejs 入门教程</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://liuyang.feblog.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  刘洋博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://js.feblog.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  javascript
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://vuejs.feblog.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuejs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/thisliuyang/nodejs-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://liuyang.feblog.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  刘洋博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://js.feblog.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  javascript
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://vuejs.feblog.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuejs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/thisliuyang/nodejs-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/00-course_introduction.html" class="sidebar-link">Nodejs</a></li><li><a href="/01-web_concept.html" class="sidebar-link">第1章 服务端开发基础</a></li><li><a href="/02-node_introduction.html" class="sidebar-link">第2章 Node.js 介绍</a></li><li><a href="/03-getting_started.html" class="sidebar-link">第3章 起步</a></li><li><a href="/04-module.html" class="sidebar-link">第4章 模块系统</a></li><li><a href="/05-package_npm.html" class="sidebar-link">第5章 包与npm</a></li><li><a href="/06-fs.html" class="sidebar-link">第6章 文件操作</a></li><li><a href="/07-web.html" class="sidebar-link">第7章 Web 开发</a></li><li><a href="/08-express.html" class="sidebar-link">第8章 使用 Express 快速进行 Web 开发</a></li><li><a href="/09-db.html" class="sidebar-link">第9章 数据库</a></li><li><a href="/10-web_db.html" class="sidebar-link">第10章 使用数据库存储网站数据</a></li><li><a href="/11-session_persistence.html" class="sidebar-link">第11章 会话保持</a></li><li><a href="/12-ajax.html" class="active sidebar-link">第12章 Ajax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/12-ajax.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#快速上手" class="sidebar-link">快速上手</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/12-ajax.html#readystate" class="sidebar-link">readyState</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#遵循-http" class="sidebar-link">遵循 HTTP</a></li></ul></li><li class="sidebar-sub-header"><a href="/12-ajax.html#具体用法" class="sidebar-link">具体用法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/12-ajax.html#get-请求" class="sidebar-link">GET 请求</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#post-请求" class="sidebar-link">POST 请求</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#同步与异步" class="sidebar-link">同步与异步</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#响应数据格式" class="sidebar-link">响应数据格式</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#处理响应数据渲染" class="sidebar-link">处理响应数据渲染</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#兼容方案" class="sidebar-link">兼容方案</a></li></ul></li><li class="sidebar-sub-header"><a href="/12-ajax.html#封装" class="sidebar-link">封装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/12-ajax.html#封装-get方法" class="sidebar-link">封装 $.get方法</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#封装-post方法" class="sidebar-link">封装 $.post方法</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#jquery-ajax" class="sidebar-link">jQuery.ajax</a></li></ul></li><li class="sidebar-sub-header"><a href="/12-ajax.html#跨域" class="sidebar-link">跨域</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#_1-1-什么是ajax跨域" class="sidebar-link">1.1 什么是ajax跨域</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#_1-2-解决跨域问题的方式" class="sidebar-link">1.2 解决跨域问题的方式</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#_1-3-cors跨域" class="sidebar-link">1.3 cors跨域</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#_1-4-jsonp跨域" class="sidebar-link">1.4 jsonp跨域</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#_1-5-ajax方法跨域操作-jsonp" class="sidebar-link">1.5 $.ajax方法跨域操作 --- jsonp</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#_1-6-调用网上接口-天气预报" class="sidebar-link">1.6 调用网上接口 --- 天气预报</a></li><li class="sidebar-sub-header"><a href="/12-ajax.html#参考链接" class="sidebar-link">参考链接</a></li></ul></li><li><a href="/13-alibaixiu.html" class="sidebar-link">第13章  阿里百秀综合案例</a></li><li><a href="/14-asynchronous_ programming.html" class="sidebar-link">第14章 异步编程</a></li><li><a href="/15-dep_ops.html" class="sidebar-link">第15章 部署与运维</a></li><li><a href="/16-other.html" class="sidebar-link">第16章 其他</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="第12章-ajax"><a href="#第12章-ajax" aria-hidden="true" class="header-anchor">#</a> 第12章 Ajax</h1> <h2 id="概述"><a href="#概述" aria-hidden="true" class="header-anchor">#</a> 概述</h2> <blockquote><p>Web 程序最初的目的就是将信息（数据）放到公共的服务器，让所有网络用户都可以通过浏览器访问。</p></blockquote> <p><img src="/assets/img/browser-server.f81905fc.png" alt="browser-server"></p> <p>在此之前，我们可以通过以下几种方式让浏览器发出对服务端的请求，获得服务端的数据：</p> <ul><li>地址栏输入地址，回车，刷新</li> <li>特定元素的 href 或 src 属性</li> <li>表单提交</li></ul> <p>这些方案都是我们无法通过或者很难通过代码的方式进行编程，<strong>如果我们可以通过 JavaScript 直接发送网络请求，那么 Web 的可能就会更多，随之能够实现的功能也会更多，至少不再是“单机游戏”。</strong></p> <p>AJAX（Asynchronous JavaScript and XML），最早出现在 2005 年的 <a href="http://google-suggest.tumblr.com/" target="_blank" rel="noopener noreferrer">Google Suggest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，是在浏览器端进行网络编程（发送请求、接收响应）的技术方案，它使我们可以通过 JavaScript 直接获取服务端最新的内容而不必重新加载页面。让 Web 更能接近桌面应用的用户体验。</p> <p>说白了，<strong>AJAX 就是浏览器提供的一套 API，可以通过 JavaScript 调用，从而实现通过代码控制请求与响应。实现网络编程。</strong></p> <blockquote><p>能力不够 API 凑。</p></blockquote> <h2 id="快速上手"><a href="#快速上手" aria-hidden="true" class="header-anchor">#</a> 快速上手</h2> <p>使用 AJAX 的过程可以类比平常我们访问网页过程</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 1. 创建一个 XMLHttpRequest 类型的对象 —— 相当于打开了一个浏览器</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 2. 打开与一个网址之间的连接 —— 相当于在地址栏输入访问地址</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'./time.php'</span><span class="token punctuation">)</span>
<span class="token comment">// 3. 通过连接发送一次请求 —— 相当于回车或者点击访问发送请求</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token comment">// 4. 指定 xhr 状态变化事件处理函数 —— 相当于处理网页呈现后的操作</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 通过 xhr 的 readyState 判断此次请求的响应是否接收完成</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过 xhr 的 responseText 获取到响应的响应体™</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="readystate"><a href="#readystate" aria-hidden="true" class="header-anchor">#</a> readyState</h3> <p>由于 <code>readystatechange</code> 事件是在 <code>xhr</code> 对象状态变化时触发（不单是在得到响应时），也就意味着这个事件会被触发多次，所以我们有必要了解每一个状态值代表的含义：</p> <table><thead><tr><th>readyState</th> <th>状态描述</th> <th>说明</th></tr></thead> <tbody><tr><td>0</td> <td>UNSENT</td> <td>代理（XHR）被创建，但尚未调用 <code>open()</code> 方法。</td></tr> <tr><td>1</td> <td>OPENED</td> <td><code>open()</code> 方法已经被调用，建立了连接。</td></tr> <tr><td>2</td> <td>HEADERS_RECEIVED</td> <td><code>send()</code> 方法已经被调用，并且已经可以获取状态行和响应头。</td></tr> <tr><td>3</td> <td>LOADING</td> <td>响应体下载中， <code>responseText</code> 属性可能已经包含部分数据。</td></tr> <tr><td>4</td> <td>DONE</td> <td>响应体下载完成，可以直接使用 <code>responseText</code>。</td></tr></tbody></table> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 代理（XHR）被创建，但尚未调用 open() 方法。</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span>
<span class="token comment">// =&gt; 0</span>

xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'./time.php'</span><span class="token punctuation">)</span>

<span class="token comment">// open() 方法已经被调用，建立了连接。</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span>
<span class="token comment">// =&gt; 1</span>

xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState<span class="token punctuation">)</span>
  <span class="token comment">// send() 方法已经被调用，并且已经可以获取状态行和响应头。</span>
  <span class="token comment">// =&gt; 2</span>
  <span class="token comment">// 响应体下载中， responseText 属性可能已经包含部分数据。</span>
  <span class="token comment">// =&gt; 3</span>
  <span class="token comment">// 响应体下载完成，可以直接使用 responseText。</span>
  <span class="token comment">// =&gt; 4</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过理解每一个状态值的含义得出一个结论：一般我们都是在 <code>readyState</code> 值为 <code>4</code> 时，执行响应的后续逻辑。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 后续逻辑......</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="遵循-http"><a href="#遵循-http" aria-hidden="true" class="header-anchor">#</a> 遵循 HTTP</h3> <p>本质上 XMLHttpRequest 就是 JavaScript 在 Web 平台中发送 HTTP 请求的手段，所以我们发送出去的请求任然是 HTTP 请求，同样符合 HTTP 约定的格式：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 设置请求报文的请求行</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'./time.php'</span><span class="token punctuation">)</span>
<span class="token comment">// 设置请求头</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Accept'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span>
<span class="token comment">// 设置请求体</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取响应状态码</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">)</span>
    <span class="token comment">// 获取响应状态描述</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>statusText<span class="token punctuation">)</span>
    <span class="token comment">// 获取响应头信息</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getResponseHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 指定响应头</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllResponseHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 全部响应头</span>
    <span class="token comment">// 获取响应体</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span> <span class="token comment">// 文本形式</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseXML<span class="token punctuation">)</span> <span class="token comment">// XML 形式，了解即可不用了</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>参考链接：</p> <ul><li>https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest</li> <li>https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest</li></ul></blockquote> <h2 id="具体用法"><a href="#具体用法" aria-hidden="true" class="header-anchor">#</a> 具体用法</h2> <h3 id="get-请求"><a href="#get-请求" aria-hidden="true" class="header-anchor">#</a> GET 请求</h3> <blockquote><p>通常在一次 GET 请求过程中，参数传递都是通过 URL 地址中的 <code>?</code> 参数传递。</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// GET 请求传递参数通常使用的是问号传参</span>
<span class="token comment">// 这里可以在请求地址后面加上参数，从而传递数据到服务端</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'./delete.php?id=1'</span><span class="token punctuation">)</span>
<span class="token comment">// 一般在 GET 请求时无需设置响应体，可以传 null 或者干脆不传</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 一般情况下 URL 传递的都是参数性质的数据，而 POST 一般都是业务数据</span>
</code></pre></div><h3 id="post-请求"><a href="#post-请求" aria-hidden="true" class="header-anchor">#</a> POST 请求</h3> <blockquote><p>POST 请求过程中，都是采用请求体承载需要提交的数据。</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// open 方法的第一个参数的作用就是设置请求的 method</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'./add.php'</span><span class="token punctuation">)</span>
<span class="token comment">// 设置请求头中的 Content-Type 为 application/x-www-form-urlencoded</span>
<span class="token comment">// 标识此次请求的请求体格式为 urlencoded 以便于服务端接收数据</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">)</span>
<span class="token comment">// 需要提交到服务端的数据可以通过 send 方法的参数传递</span>
<span class="token comment">// 格式：key1=value1&amp;key2=value2</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'key1=value1&amp;key2=value2'</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="同步与异步"><a href="#同步与异步" aria-hidden="true" class="header-anchor">#</a> 同步与异步</h3> <p>关于同步与异步的概念在生活中有很多常见的场景，举例说明。</p> <blockquote><p>同步：一个人在同一个时刻只能做一件事情，在执行一些耗时的操作（不需要看管）不去做别的事，只是等待</p> <p>异步：在执行一些耗时的操作（不需要看管）去做别的事，而不是等待</p></blockquote> <p><code>xhr.open()</code> 方法第三个参数要求传入的是一个 <code>bool</code> 值，其作用就是设置此次请求是否采用异步方式执行，默认为 <code>true</code>，如果需要同步执行可以通过传递 <code>false</code> 实现：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'before ajax'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 默认第三个参数为 true 意味着采用异步方式执行</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'./time.php'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里的代码最后执行</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'request done'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'after ajax'</span><span class="token punctuation">)</span>
</code></pre></div><p>如果采用同步方式执行，则代码会卡死在 <code>xhr.send()</code> 这一步：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'before ajax'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 同步方式</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'./time.php'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">// 同步方式 执行需要 先注册事件再调用 send，否则 readystatechange 无法触发</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里的代码最后执行</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'request done'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'after ajax'</span><span class="token punctuation">)</span>
</code></pre></div><p>演示同步异步差异。</p> <p>一定在发送请求 <code>send()</code> 之前注册 <code>readystatechange</code>（不管同步或者异步）</p> <ul><li>为了让这个事件可以更加可靠（一定触发），一定是先注册</li></ul> <p>了解同步模式即可，切记不要使用同步模式。</p> <p>至此，我们已经大致了解了 AJAX 的基本 API 。</p> <h3 id="响应数据格式"><a href="#响应数据格式" aria-hidden="true" class="header-anchor">#</a> 响应数据格式</h3> <blockquote><p>提问：如果希望服务端返回一个复杂数据，该如何处理？</p></blockquote> <p>关心的问题就是服务端发出何种格式的数据，这种格式如何在客户端用 JavaScript 解析。</p> <h4 id="xml"><a href="#xml" aria-hidden="true" class="header-anchor">#</a> XML</h4> <p>一种数据描述手段</p> <p>老掉牙的东西，简单演示一下，不在这里浪费时间，基本现在的项目不用了。</p> <p>淘汰的原因：数据冗余太多</p> <h4 id="json"><a href="#json" aria-hidden="true" class="header-anchor">#</a> JSON</h4> <p>也是一种数据描述手段，类似于 JavaScript 字面量方式</p> <p>服务端采用 JSON 格式返回数据，客户端按照 JSON 格式解析数据。</p> <blockquote><p>不管是 JSON 也好，还是 XML，只是在 AJAX 请求过程中用到，并不代表它们之间有必然的联系，它们只是数据协议罢了</p></blockquote> <h3 id="处理响应数据渲染"><a href="#处理响应数据渲染" aria-hidden="true" class="header-anchor">#</a> 处理响应数据渲染</h3> <blockquote><p>模板引擎：</p> <ul><li>artTemplate：https://aui.github.io/art-template/</li></ul></blockquote> <p>模板引擎实际上就是一个 API，模板引擎有很多种，使用方式大同小异，目的为了可以更容易的将数据渲染到HTML中</p> <h3 id="兼容方案"><a href="#兼容方案" aria-hidden="true" class="header-anchor">#</a> 兼容方案</h3> <p>XMLHttpRequest 在老版本浏览器（IE5/6）中有兼容问题，可以通过另外一种方式代替</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> XMLHttpRequest <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">'Microsoft.XMLHTTP'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="封装"><a href="#封装" aria-hidden="true" class="header-anchor">#</a> 封装</h2> <h3 id="封装-get方法"><a href="#封装-get方法" aria-hidden="true" class="header-anchor">#</a> 封装 $.get方法</h3> <p>目标： 封装一个 $.get 方法，能够发送get方式的Ajax请求，并且接收到后端的返回数据</p> <p>实现思路：</p> <ol><li><p>编写一个具体的发送get方式的Ajax请求程序，并封装为函数</p></li> <li><p>分装该函数的缺陷</p></li> <li><p>解决缺陷</p></li></ol> <p>代码实现：</p> <ol><li>编写一个具体的发送get方式的Ajax请求程序，并封装为函数</li></ol> <p>目标： 发送get方式的Ajax请求，能够请求到 /getData，并且能够将id=1这个数据发送到后端。还能接收到后端返回的数据</p> <p><img src="/assets/img/15510607153031553325852818.076d716b.png" alt="1551060715303"></p> <ol start="2"><li>分装该函数的缺陷</li></ol> <p>① 创建 xhr 对象时，没有考虑兼容性问题</p> <p>② 请求的后端地址永远都是 /getData</p> <p>③ 发送给后端的数据永远都是 id=1</p> <p>④ 处理接收到的后端结果方式单一，只能alert()</p> <ol start="3"><li>解决缺陷</li></ol> <p>① 创建 xhr 对象时，没有考虑兼容性问题</p> <p><img src="/assets/img/15510610722671553325871563.60d91195.png" alt="1551061072267"></p> <p>② 请求的后端地址永远都是 /getData</p> <p><img src="/assets/img/15510612439851553325885249.fb05eb94.png" alt="1551061243985"></p> <p>​    ③ 发送给后端的数据永远都是 id=1</p> <p><img src="/assets/img/1551061350487-1553325901395.11c38a80.png" alt="1551061350487"></p> <p>④ 处理接收到的后端结果方式单一，只能alert()</p> <p>解决方案: 使用回调函数</p> <p><img src="/assets/img/1551061854487-1553325913136.730a39db.png" alt="1551061854487"></p> <p>在调用 $.get 方法时，参数3传入了一个函数（回调函数）。可以在该函数中随意写代码，操作DOM对象，或者alert弹出或者console.log输出都行。</p> <p><img src="/assets/img/1551061868775-1553325925905.fef3a91c.png" alt="1551061868775"></p> <h3 id="封装-post方法"><a href="#封装-post方法" aria-hidden="true" class="header-anchor">#</a> 封装 $.post方法</h3> <p>目标：$.post() 能够发送一个post方式的Ajax请求，并且能够接收到后端返回的数据</p> <p>实现思路：</p> <ol><li><p>编写一个具体的案例
具体案例:  封装一个post方法，能够发送ajax请求，请求 /postData ，并且能接收到 /postData 的返回数据</p></li> <li><p>分析缺陷</p></li></ol> <p>​   ① 只能访问 /postData 程序
② 无法灵活向后台的 /postData 程序发送参数
③ 前端无法灵活接收后端返回的数据</p> <ol start="3"><li>解决缺陷</li></ol> <p>代码实现：</p> <ol><li>编写一个具体的案例
具体案例:  封装一个post方法，能够发送ajax请求，请求 /postData ，并且能接收到 /postData 的返回数据</li></ol> <p><img src="/assets/img/1551063381578-1553325940371.9852f030.png" alt="1551063381578"></p> <ol start="2"><li><p>缺陷分析</p> <p>① 请求的地址必须是 /postData</p> <p>② 没有向后端发送数据的操作</p> <p>③ 后端返回的结果只能被alert()</p></li> <li><p>解决缺陷</p> <p>① 请求的地址必须是 /postData</p></li></ol> <p><img src="/assets/img/1551063585441-1553325952667.8ec16f5b.png" alt="1551063585441"></p> <p>​     ② 没有向后端发送数据的操作</p> <p><img src="/assets/img/1551063766595-1553325964783.6d97f847.png" alt="1551063766595"></p> <p>​    ③ 后端返回的结果只能被alert()</p> <p><img src="/assets/img/1551063901990-1553325975966.d14a759f.png" alt="1551063901990"></p> <h3 id="jquery-ajax"><a href="#jquery-ajax" aria-hidden="true" class="header-anchor">#</a> jQuery.ajax</h3> <p>在jquery中封装了4个ajax方法： <code>$.get $.post $.ajax $.getJson</code></p> <p>常用前三个 <code>$.get $.post $.ajax</code></p> <h4 id="get方法"><a href="#get方法" aria-hidden="true" class="header-anchor">#</a> $.get方法</h4> <p>$.get(var1, var2, var3, var4);
参数1: 请求的后端程序的地址
参数2: 要发送到后端程序的数据，json对象/js对象（推荐）或者 字符串
参数3: 当readyState==4时的触发函数，该函数中有一个参数，就是后端程序返回的数据
参数4: 设置返回数据的类型:  text(默认)  json     xml</p> <p>{id:1, name:&quot;zs&quot;}  ==&gt;  id=1&amp;name=zs</p> <p>xhr.open('get', '/getData?id=1&amp;name=zs');</p> <p>案例1 在get.html文件中发送一个ajax请求，去请求后端的 /getData，同时将id=1数据发送给后端</p> <p><img src="/assets/img/1551065279553-1553326075223.b2d2b9d6.png" alt="1551065279553"></p> <p>参数1： 请求的后端页面的地址</p> <p>参数2： 发送给后端的数据。可以使用 字符串  js对象  json对象</p> <div class="language- extra-class"><pre class="language-text"><code>    id=1    {id:1}  {&quot;id&quot;:1} , js对象和json对象会被自动转为 id=1的字符串

    前两个参数会组合成open方法的参数2    /getData?id=1
</code></pre></div><p>参数3： readyState=4时的回调函数，参数data就是后端返回的数据</p> <p>参数4： 后端返回的数据类型，可以使用  text(默认)   json   xml</p> <div class="language- extra-class"><pre class="language-text"><code>    后端返回的是一个普通字符串，则使用text

    后端返回的是json字符串，则使用json，相当于执行了 JSON.parse将返回的json字符串转为json对象
</code></pre></div><p>案例2 使用$.get改造用户名搜索案例</p> <p>完成功能的思路是一样的，只是发送Ajax请求的操作由原生方式变为$.get方式</p> <ol><li><p>在搜索按钮上注册点击事件，获取关键词，发送Ajax请求并将关键词一起发送给后端</p></li> <li><p>后端接收关键词，编写SQL语句并执行，再将结果返回给前端</p></li> <li><p>前端接收后端数据，再将数据显示到网页上</p></li></ol> <p>代码实现:</p> <ol><li>在搜索按钮上注册点击事件，获取关键词，发送Ajax请求并将关键词一起发送给后端</li></ol> <p><img src="/assets/img/1551066997772-1553326150484.ee67c0aa.png" alt="1551066997772"></p> <ol start="2"><li><p>后端接收关键词，编写SQL语句并执行，再将结果返回给前端</p> <p>使用原来 /search 地址，程序不用修改</p></li> <li><p>前端接收后端数据，再将数据显示到网页上</p></li></ol> <p><img src="/assets/img/1551067231054-1553326164922.034df864.png" alt="1551067231054"></p> <h4 id="post方法"><a href="#post方法" aria-hidden="true" class="header-anchor">#</a> $.post方法</h4> <p><code>$.post</code>函数的用法和<code>$.get</code>一模一样，只是发送请求方式变为post</p> <p>$.post(var1, var2, var3 , var4);    //最标准的写法
参数1: 请求的后端程序的地址
参数2: 要发送到后端程序的数据，json对象/js对象（推荐） 或者 字符串
参数3: 当readyState=4时的触发函数，该函数中有一个参数，就是后台程序返回的数据
参数4: 设置返回数据的类型:  text(默认)  json    xml</p> <p>案例: 在post.html文件中发送一个ajax请求，去请求后端的 /postData ，同时将id=1数据发送给后端</p> <p><img src="/assets/img/1551067737212-1553326179172.a6668553.png" alt="1551067737212"></p> <h2 id="跨域"><a href="#跨域" aria-hidden="true" class="header-anchor">#</a> 跨域</h2> <h2 id="_1-1-什么是ajax跨域"><a href="#_1-1-什么是ajax跨域" aria-hidden="true" class="header-anchor">#</a> 1.1 什么是ajax跨域</h2> <p>简单来说，就是网站A去调用网站B的数据。
常见案例： hao123.com的天气预报。</p> <p>但是Ajax跨域存在一个问题 --- 浏览器的同源策略，该策略会阻止ajax跨域访问
同源策略（Same origin policy）是一种约定，它是浏览器的一种安全功能。
同源:  同协议，同域名，同端口；   不同源则为跨域</p> <p><img src="/../../../../web/08ajax/ajax-5/%E7%AC%94%E8%AE%B0/assets/5.png" alt="1526464487997"></p> <p>同源限制案例:
127.0.0.1:3000/index ---&gt; index.html 中使用ajax请求 127.0.0.1:8888/getData，并获取到返回的数据</p> <p>因为端口号不一样，所以是不同的服务器</p> <p>实现思路:</p> <ol><li><p>创建 127.0.0.1:3000 服务器，并显示index.html页面；在index.html页面中使用jquery 方式发送Ajax请求，请求 127.0.0.1:8888/getData</p></li> <li><p>创建 127.0.0.1:8888 服务器，在 /getData 路由中返回一个字符串</p></li></ol> <p><img src="data:image/png;base64,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" alt="1551320793024"></p> <p>服务器1： 端口号是3000的服务器，要在该服务器上发送Ajax请求</p> <p>服务器2： 端口号是8888的服务器，要在该服务器上返回Ajax请求的结果</p> <ol><li>创建 127.0.0.1:3000 服务器，并显示index.html页面；在index.html页面中使用jquery 方式发送Ajax请求，请求 127.0.0.1:8888/index</li></ol> <p><img src="/assets/img/1551320851108-1553326370270.d1fed00b.png" alt="1551320851108"></p> <p><img src="/assets/img/1551320870007-1553326386522.67d86d88.png" alt="1551320870007"></p> <ol start="2"><li>创建 127.0.0.1:8888 服务器，在 /getData 路由中返回一个字符串</li></ol> <p><img src="/assets/img/1551320890497-1553326398483.5e6b6f76.png" alt="1551320890497"></p> <p>访问结果:</p> <p><img src="/assets/img/1551320910942-1553326411361.8173114a.png" alt="1551320910942"></p> <p>==当看到返回结果中有 'Access-Control-Allow-Origin' 时，就说明Ajax的跨域请求失败了。==</p> <p>查看 /getData 的响应体，发现已经有了后端返回的结果。但是，依然不能用，说明是浏览器不让使用后端返回的数据</p> <p><img src="/assets/img/1551320968813-1553326423966.87837638.png" alt="1551320968813"></p> <h2 id="_1-2-解决跨域问题的方式"><a href="#_1-2-解决跨域问题的方式" aria-hidden="true" class="header-anchor">#</a> 1.2 解决跨域问题的方式</h2> <ul><li>服务器代理</li> <li>cors （跨域资源共享）</li> <li>jsonp</li></ul> <h2 id="_1-3-cors跨域"><a href="#_1-3-cors跨域" aria-hidden="true" class="header-anchor">#</a> 1.3 cors跨域</h2> <p>cors: 跨域资源共享。
==同源策略是浏览器的策略==。但是如果服务器允许其他网站的页面进行跨域访问，那么浏览器就不会对返回的数据进行限制了。</p> <p>Nodejs中要使用cors方法解决跨域问题，需要安装第三方模块 cors  ---&gt;  <code>npm i cors</code></p> <p>cors的使用方法：  后端程序</p> <p>cors.js文件中解决跨域的代码就两句</p> <p><img src="/assets/img/1551322357558-1553326457724.ea43dc78.png" alt="1551322357558"></p> <p>访问结果:</p> <p><img src="data:image/png;base64,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" alt="1551322386873"></p> <h2 id="_1-4-jsonp跨域"><a href="#_1-4-jsonp跨域" aria-hidden="true" class="header-anchor">#</a> 1.4 jsonp跨域</h2> <p>JSONP(JSON with Padding) : 是一种解决ajax跨域访问的方案。</p> <p>核心思想:
浏览器虽然有同源策略，但是 src 和 href 两个属性却可以跨域访问。 可以利用这一“漏洞”来请求另一个网站的页面。</p> <p>从原理上将 jsonp 是不属于Ajax范畴的，它是使用 script标签的src来发送请求。但是实现的效果和Ajax是一致的</p> <ol><li>后端返回一个函数调用的字符串</li></ol> <p>res.send('aaa(&quot;Hello Ajax&quot;)');</p> <ol start="2"><li>前端要声明该函数</li></ol> <p>function  aaa (data) {</p> <p>​	alert(data);</p> <p>}</p> <ol><li>后端的 /getData 方法返回了一个aaa() 字符串</li></ol> <p><img src="/assets/img/1551323509153-1553326486532.a1055a0d.png" alt="1551323509153"></p> <ol start="2"><li>前端使用 script 标签，请求了 /getData，就能得到 aaa()</li></ol> <p><img src="/assets/img/1551323585382-1553326497984.215e4310.png" alt="1551323585382"></p> <p><img src="/assets/img/1551323990492-1553326510353.c1824ead.png" alt="1551323990492"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">&quot;zs&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">'我叫'</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">', 今年'</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span>age <span class="token operator">+</span> <span class="token string">'岁'</span>；

<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token template-string"><span class="token string">`我叫&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;,今年'</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'岁`</span></span><span class="token punctuation">;</span> <span class="token comment">//我叫&quot;zs&quot;，今年'20'岁</span>
</code></pre></div><h2 id="_1-5-ajax方法跨域操作-jsonp"><a href="#_1-5-ajax方法跨域操作-jsonp" aria-hidden="true" class="header-anchor">#</a> 1.5 $.ajax方法跨域操作 --- jsonp</h2> <p><code>$.post $.get $.ajax都能发送跨域请求。但是，$.post和$.get是要依靠cors方式的，只有$.ajax能使用jsonp方式</code></p> <p>核心:
必须设置请求类型为get ---  type: ‘get’
必须设置dataType为jsonp --- dataType: ‘jsonp’
必须额外设置一个jsonp参数，该参数值可以是任何英文字符串，常用callback。 jsonp: 'callback'
==该参数会产生一个随机字符串==
==前端使用该字符串创建一个函数==
==后端接收该字符串作为返回函数的名称==</p> <p>示例:</p> <ol><li>使用jsonp发送跨域请求</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> <span class="token string">'http://127.0.0.1:8888/getData'</span><span class="token punctuation">,</span>  <span class="token comment">//请求的后端地址</span>
    type<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>   
    dataType<span class="token punctuation">:</span> <span class="token string">'jsonp'</span><span class="token punctuation">,</span>   
    jsonp<span class="token punctuation">:</span> <span class="token string">'callback'</span><span class="token punctuation">,</span>   <span class="token comment">//解决前后端函数名统一的问题   </span>
    success<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">alert</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>后端拼接函数字符串</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/getData'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">//接收 callback 传递的函数名</span>
  	<span class="token keyword">const</span> func <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>callback<span class="token punctuation">;</span>
    
    <span class="token comment">//返回函数字符串</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>func <span class="token operator">+</span> <span class="token string">'({code:200,message:&quot;请求成功&quot;})'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>案例: 127.0.0.1:3000/index  --&gt; index.html 页面中使用 $.ajax方法跨域请求后端  127.0.0.1:8888/getData</p> <ol><li>27.0.0.1:3000/index  --&gt; index.html 页面中使用 $.ajax方法跨域请求</li></ol> <p><img src="/assets/img/1551325799431-1553326526688.e360a3d9.png" alt="1551325799431"></p> <ol start="2"><li>后端  127.0.0.1:8888/getData</li></ol> <p><img src="/assets/img/1551325842809-1553326543131.9dbe0a49.png" alt="1551325842809"></p> <p>访问结果:</p> <p><img src="/assets/img/1551325870327-1553326563296.091886df.png" alt="1551325870327"></p> <h2 id="_1-6-调用网上接口-天气预报"><a href="#_1-6-调用网上接口-天气预报" aria-hidden="true" class="header-anchor">#</a> 1.6 调用网上接口 --- 天气预报</h2> <p>网站： www.jisuapi.com</p> <p><img src="/assets/img/7-1553326578248-1553326579095.efaa1e41.png" alt="7"></p> <p>api说明:</p> <p><img src="/assets/img/8-1553326592948-1553326593691.13bbd97d.png" alt="8"></p> <p>注册，购买后可在“我的api”中看到</p> <p><img src="/assets/img/9-1553326786273.0380202a.png" alt="9"></p> <p><img src="/assets/img/10-1553326798075.2111e8ea.png" alt="10"></p> <p>1） 发送ajax请求</p> <p><img src="/assets/img/1551327622780-1553326831568.b653645e.png" alt="1551327622780"></p> <ol start="2"><li>将取得数据筛选后显示到网页上</li></ol> <p><img src="/assets/img/1551327580077-1553326845864.2077f450.png" alt="1551327580077"></p> <p>http://api.jisuapi.com/weather/query?appkey=1dc381f43936cdf7&amp;city=北</p> <h2 id="参考链接"><a href="#参考链接" aria-hidden="true" class="header-anchor">#</a> 参考链接</h2> <ul><li>http://www.w3school.com.cn/ajax/index.asp</li> <li>https://aui.github.io/art-template/zh-cn</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/thisliuyang/nodejs-tutorial/edit/master/docs/12-ajax.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">3/23/2019, 11:26:52 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/11-session_persistence.html" class="prev">
          第11章 会话保持
        </a></span> <span class="next"><a href="/13-alibaixiu.html">
          第13章  阿里百秀综合案例
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.8174091a.js" defer></script><script src="/assets/js/3.07be1171.js" defer></script>
  </body>
</html>
